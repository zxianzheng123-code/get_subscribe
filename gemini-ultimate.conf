# Clash Meta é…ç½®æ–‡ä»¶
# é€‚ç”¨äºï¼šClash Meta / Clash Verge / Stash

mixed-port: 7890
allow-lan: true
bind-address: '*'
mode: rule
log-level: info
external-controller: 127.0.0.1:9090

dns:
  enable: true
  enhanced-mode: fake-ip
  nameserver:
    - 223.5.5.5
    - 119.29.29.29
  fallback:
    - 8.8.8.8
    - 1.1.1.1

# ===========================================
# ä»£ç†èŠ‚ç‚¹ï¼ˆæ‰‹åŠ¨æ·»åŠ æˆ–ä½¿ç”¨è®¢é˜…ï¼‰
# ===========================================
proxies:
  # ç¤ºä¾‹èŠ‚ç‚¹ï¼Œæ›¿æ¢ä¸ºä½ çš„å®é™…èŠ‚ç‚¹
  # - name: "ç¾å›½01"
  #   type: ss
  #   server: xxx.xxx.xxx
  #   port: 443
  #   cipher: aes-256-gcm
  #   password: "password"

# ===========================================
# ä»£ç†æä¾›è€…
# ===========================================
proxy-providers:
  my-subscription:
    type: http
    url: "æ›¿æ¢ä¸ºä½ çš„è®¢é˜…é“¾æ¥"
    path: ./proxies/sub.yaml
    interval: 86400
    health-check:
      enable: true
      url: "https://api.openai.com/v1/models"
      interval: 300

# ===========================================
# ä»£ç†ç»„
# ===========================================
proxy-groups:
  # 1ï¸âƒ£ ä¸»å…¥å£é€‰æ‹©å™¨
  - name: "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
    type: select
    proxies:
      - "ğŸ¤– AIæœåŠ¡ä¼˜é€‰"
      - "âš¡ ä½å»¶è¿Ÿä¼˜é€‰"
      - "ğŸ”° æ•…éšœè½¬ç§»"
      - DIRECT

  # 2ï¸âƒ£ AIæœåŠ¡ä¸“ç”¨ç»„ - æ ¸å¿ƒé…ç½®
  - name: "ğŸ¤– AIæœåŠ¡ä¼˜é€‰"
    type: url-test
    use:
      - my-subscription
    # æ’é™¤è§„åˆ™è¯´æ˜ï¼š
    # æ¸¯|HK = é¦™æ¸¯
    # æ¾³|MO = æ¾³é—¨  
    # ä¿„|RU = ä¿„ç½—æ–¯
    # ç™½ä¿„|BY = ç™½ä¿„ç½—æ–¯
    # ä¼Šæœ—|IR = ä¼Šæœ—
    # æœé²œ|KP = æœé²œ
    # æ ¹æ®éœ€è¦å¯æ·»åŠ æ›´å¤š
    filter: "(?i)^(?!.*(æ¸¯|HK|Hong Kong|æ¾³é—¨|MO|Macao|ä¿„ç½—æ–¯|RU|Russia|ç™½ä¿„|BY|Belarus|ä¼Šæœ—|IR|Iran|æœé²œ|KP|å™åˆ©äºš|SY|å¤å·´|CU)).*$"
    url: "https://api.openai.com/v1/models"
    interval: 180
    tolerance: 100
    lazy: false

  # 3ï¸âƒ£ ä½å»¶è¿Ÿå¤‡é€‰
  - name: "âš¡ ä½å»¶è¿Ÿä¼˜é€‰"
    type: url-test
    use:
      - my-subscription
    filter: "(?i)(ç¾|US|USA|æ—¥|JP|Japan|æ–°|SG|Singapore|éŸ©|KR|Korea)"
    url: "https://www.gstatic.com/generate_204"
    interval: 300
    tolerance: 50

  # 4ï¸âƒ£ æ•…éšœè½¬ç§»
  - name: "ğŸ”° æ•…éšœè½¬ç§»"
    type: fallback
    use:
      - my-subscription
    filter: "(?i)^(?!.*(æ¸¯|HK|æ¾³|MO|ä¿„|RU)).*$"
    url: "https://api.openai.com/v1/models"
    interval: 300

  # 5ï¸âƒ£ æ‰‹åŠ¨é€‰æ‹©ï¼ˆå…¨éƒ¨èŠ‚ç‚¹ï¼‰
  - name: "ğŸ”§ æ‰‹åŠ¨åˆ‡æ¢"
    type: select
    use:
      - my-subscription

# ===========================================
# åˆ†æµè§„åˆ™
# ===========================================
rule-providers:
  openai:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/OpenAI/OpenAI.yaml"
    path: ./rules/openai.yaml
    interval: 86400

rules:
  # AI æœåŠ¡èµ°ä¼˜é€‰èŠ‚ç‚¹
  - RULE-SET,openai,ğŸ¤– AIæœåŠ¡ä¼˜é€‰
  
  # Gemini
  - DOMAIN-SUFFIX,gemini.google.com,ğŸ¤– AIæœåŠ¡ä¼˜é€‰
  - DOMAIN-SUFFIX,generativelanguage.googleapis.com,ğŸ¤– AIæœåŠ¡ä¼˜é€‰
  - DOMAIN-SUFFIX,ai.google.dev,ğŸ¤– AIæœåŠ¡ä¼˜é€‰
  - DOMAIN-SUFFIX,aistudio.google.com,ğŸ¤– AIæœåŠ¡ä¼˜é€‰
  - DOMAIN-KEYWORD,bard,ğŸ¤– AIæœåŠ¡ä¼˜é€‰
  
  # Claude
  - DOMAIN-SUFFIX,anthropic.com,ğŸ¤– AIæœåŠ¡ä¼˜é€‰
  - DOMAIN-SUFFIX,claude.ai,ğŸ¤– AIæœåŠ¡ä¼˜é€‰
  
  # å…¶ä»–å¸¸ç”¨è§„åˆ™
  - GEOIP,CN,DIRECT
  - MATCH,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
